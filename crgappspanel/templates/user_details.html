{% extends "base.html" %}
{% load i18n %}

{% block title %}{% trans "User details" %}: {{ user.given_name }} {{ user.family_name }}{% endblock %}

{% block content %}
<script type="text/javascript">
goog.require('goog.ui.Dialog')
</script>
<script type="text/javascript">
var dialogSuspend = new goog.ui.Dialog()
dialogSuspend.setTitle('{% trans "Suspend user" %}')
dialogSuspend.setContent('{% trans "Are you sure want to suspend selected user?" %}')
dialogSuspend.setButtonSet(goog.ui.Dialog.ButtonSet.YES_NO)

goog.events.listen(dialogSuspend, goog.ui.Dialog.EventType.SELECT, function(e) {
	if (e.key == 'yes') {
		open('{% url user-suspend user.user_name %}', '_self')
	}
})

var dialogRestore = new goog.ui.Dialog()
dialogRestore.setTitle('{% trans "Restore user" %}')
dialogRestore.setContent('{% trans "Are you sure want to restore selected user?" %}')
dialogRestore.setButtonSet(goog.ui.Dialog.ButtonSet.YES_NO)

goog.events.listen(dialogRestore, goog.ui.Dialog.EventType.SELECT, function(e) {
	if (e.key == 'yes') {
		open('{% url user-restore user.user_name %}', '_self')
	}
})

goog.events.listen(window, 'unload', function() {
	goog.events.removeAll()
})

function showDialog(dialog) {
	dialog.setVisible(true)
}
</script>

{% include "snippets/saved_warning.html" %}
<form action="" method="POST" class="details">
	{% include "snippets/user_header.html" %}
	{% if user.suspended %}
	<a href="#" onclick="showDialog(dialogRestore)">{% trans "Restore" %}</a>
	{% else %}
	<a href="#" onclick="showDialog(dialogSuspend)">{% trans "Suspend" %}</a>
	{% endif %}
	<table class="details" width="100%">
		<tbody>
			{% with form.user_name as field %}{% include "snippets/form_field.html" %}{% endwith %}
			{% with form.password as field %}{% include "snippets/form_field.html" %}{% endwith %}
			{% with form.change_password as field %}{% include "snippets/form_field.html" %}{% endwith %}
			{% with form.full_name as field %}{% include "snippets/form_field.html" %}{% endwith %}
			{% with form.nicknames as field %}{% with full_nicknames as items %}
				{% include "snippets/form_field_with_items.html" %}
			{% endwith %}{% endwith %}
			{% include "snippets/form_save_reset.html" %}
		</tbody>
	</table>
</form>
{% endblock %}
